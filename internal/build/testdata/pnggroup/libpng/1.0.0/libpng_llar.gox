import (
	"bytes"
	"path/filepath"
)
id "pnggroup/libpng"

fromVer "1.0.0"

onRequire (proj, dep) => {
	// You should use zlib 1.0.4 or later to run this
	dep.require "madler/zlib", "1.2.11"
}

onBuild (proj, out) => {

	for dep in proj.Deps {
		use dep, proj.Matrix
		echo "use ${dep.ID} ${dep.Version}"
	}

	capout => {
		exec "./configure", "--prefix", proj.BuildDir
		exec "make"
		exec "make", "install"
	}
	echo output

	if lastErr != nil {
		return lastErr
	}

	echo proj.BuildDir

	out.OutputDir = proj.BuildDir

	return nil
}
