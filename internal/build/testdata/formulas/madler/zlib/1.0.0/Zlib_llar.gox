id "madler/zlib"

fromVer "1.0.0"

onBuild (ctx, proj, out) => {
	installDir, err := ctx.outputDir()
	if err != nil {
		out.addErr err
		return
	}

	c := cmake.new(ctx.SourceDir, ctx.SourceDir+"/_build", installDir)
	c.buildType "Release"
	c.define "CMAKE_POLICY_VERSION_MINIMUM", "3.5"

	err = c.configure()
	if err != nil {
		out.addErr err
		return
	}
	err = c.build()
	if err != nil {
		out.addErr err
		return
	}
	err = c.install()
	if err != nil {
		out.addErr err
		return
	}

	out.setMetadata "-lz"
}
